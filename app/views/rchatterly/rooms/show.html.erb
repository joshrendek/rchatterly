<p id="notice"><%= notice %></p>

<p>
  <b>Name:</b>
  <%= @room.name %>
</p>


<%= javascript_include_tag :defaults, "http://localhost:9292/faye.js" %>
<%= link_to "Rooms", rooms_path %>
 |
<% Rchatterly::Room.all.each do |room| %>
    <%= link_to room, room %>
<% end %>
<script type="text/javascript">
$(function() {
  var faye = new Faye.Client('http://localhost:9292/faye');
  faye.subscribe('/messages/<%=@room.id%>', function (data) {
      $("#chat").append(data + '<br>');
  });

  $('#send').live('click', function() { 
      $("#chat").append($('#content').val() + '<br>');
      $("#new_message")[0].reset();
      });
});</script>

<ul id="chat">
</ul>

<%= form_for :message, :path => generic_index_path, :remote => true, :id => 'new_message' do |f| %>
    <%= text_field_tag :content, nil, :id => 'content'%>
  <%= submit_tag "Send", :id => 'send' %>
<% end %>


